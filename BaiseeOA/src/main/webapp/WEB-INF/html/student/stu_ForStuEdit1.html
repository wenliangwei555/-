<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
	xmlns:th="http://www.thymeleaf.org">
<head th:include="commonTemplate :: header">
</head>
<body class="bgcolor-body">
	<div id="page">
		<div th:include="commonTemplate :: headerDiv"></div>
		<div id="content" class="layout">
			<div class="grid-s5m0">
				<div class="col-main">
					<div class="main-wrap">
						<div class="skin-box">
							<div class="skin-box-bd">
								<div class="cur-position">
									<span><a href="javascript:void(0)">信息管理</a> </span> <span>&gt;</span>
									<span><a th:href="@{stu/toForStuList.ht}">学生信息</a> </span> <span>&gt;</span>
									<span><a href="javascript:void(0)">编辑信息</a> </span>
								</div>
								<!-- ==================================== 页面内容开始 ============================= -->
								<div class="cont-box">
									<div class="JsW skin-box-bd" data-widget-type="tab"
										data-widget-config="{'activeIndex':0}">
										<div class="skin-bd-box">
											<div class="content-box-menu">
												<ul>
													<li class="active"><a href="javascript:void(0)"> <span>基础信息</span>
															<span class="separator"></span>
													</a></li>
													<li><a href="javascript:void(0)"> <span
															onclick="notSupJump();">附加信息</span> <span
															class="separator"></span>
													</a></li>
													<li><a href="javascript:void(0)"><span
															onclick="notEduJump();">教育信息</span> <span
															class="separator"></span> </a></li>
													<li><a href="javascript:void(0)"> <span
															onclick="notFamJump();">家庭信息</span> <span
															class="separator"></span>
													</a></li>

												</ul>
											</div>
											<div class="list-table">
												<div class="list-table-cont">
													<div class="table6">

														<form id="basefrm" name="basefrm"
															th:action="@{stu/toUpdateForStu.ht(stuTable=forStudent)}"
															method="post" enctype="multipart/form-data">

															<table>
																<span
																	th:if="${stu.stuId} != null and ${stu.stuId} != ''">
																	<tr>
																		<td>
																			<div class="left">
																				<div class="td1">
																					<span class="red"></span><span>学员ID：</span>
																				</div>
																				<div class="td2">
																					<span> <span id="stuID" name="stuID"
																						th:text="${stu.stuId}"></span> <span> <a
																							th:if="${stu.openHouseholdState == 0}"
																							th:onclick="'openHou(\'' + ${stu.stuId} + '\')'"
																							style="cursor: pointer; color: red;">开通学生账户</a> <a
																							th:if="${stu.openHouseholdState == 1}"
																							th:onclick="'logout(\'' + ${stu.stuId} + '\')'"
																							style="cursor: pointer; color: red;">注销学生账户</a>
																					</span>
																					</span>
																				</div>
																			</div>

																		</td>
																	</tr>
																</span>
																<tr>
																	<td>
																		<div class="left">
																			<div class="td1">
																				<span class="red">*</span><span>输入姓名：</span>
																			</div>
																			<div class="td2">
																				<span> <input type="hidden" name="stuId"
																					id="stuId" th:value="${stu.stuId}" /> <input
																					type="hidden" name="operationSuccess"
																					id="operationSuccess"
																					th:value="${operationSuccess}" /> <input
																					type="text" class="radius3 input" id="stuName"
																					name="stuName" th:value="${stu.stuName}" />
																				</span>
																			</div>
																		</div>
																	</td>
																</tr>
																<tr>
																	<td>
																		<div class="left">
																			<div class="td1">
																				<span class="red">*</span><span>选择性别：</span>
																			</div>
																			<div class="td2">
																				<div class="control-css3select css3select-icon-hide">
																					<select th:if="${stu.stuSex == '0'}" name="stuSex"
																						class="radius3" id="stuSex">
																						<option value="0" selected="selected">男</option>
																						<option value="1">女</option>
																					</select> <select th:if="${stu.stuSex == '1'}" name="stuSex"
																						class="radius3" id="stuSex">
																						<option value="0">男</option>
																						<option value="1" selected="selected">女</option>
																					</select>
																				</div>
																			</div>
																		</div>
																	</td>
																</tr>
																<tr>
																	<td>
																		<div class="left">
																			<div class="td1">
																				<span class="red">*</span><span>选择班级：</span>
																			</div>
																			<div class="td2">
																				<div class="control-css3select css3select-icon-hide">
																					<select th:if="${stu.claId} != null " name="claId"
																						class="radius3" id="class_select">
																						<option th:each="info:${list}"
																							th:value="${info.cId}" th:text="${info.cName}"></option>
																					</select>
																				</div>

																			</div>

																		</div>
																	</td>
																</tr>
																<tr>
																	<td>
																		<div class="left">
																			<div class="td1">
																				<span class="red"></span><span>入学时间：</span>
																			</div>
																			<div class="td2">
																				<span><input type="text"
																					class="radius3 input" id="stuEnrolmentTime"
																					name="stuEnrolmentTime"
																					th:value="${stu.stuEnrolmentTime}"
																					readonly="readonly" /></span>
																			</div>
																		</div>
																	</td>
																</tr>
																<tr>
																	<td>
																		<div class="left">
																			<div class="td1">
																				<span class="red">*</span><span>输入身份证号：</span>
																			</div>
																			<div class="td2">
																				<span> <input type="text"
																					class="radius3 input" id="stuIdNumber"
																					name="stuIdNumber" th:value="${stu.stuIdNumber}" /></span>
																			</div>
																		</div>
																	</td>
																</tr>
																<tr>
																	<td>
																		<div class="left">
																			<div class="td1">
																				<span class="red">*</span><span>输入手机号：</span>
																			</div>
																			<div class="td2">
																				<span> <input type="text"
																					class="radius3 input" id="stuMobile"
																					name="stuMobile" th:value="${stu.stuMobile}" /></span>
																			</div>
																		</div>
																	</td>
																</tr>
																<!-- <tr>
																		<td>
																			<div class="left">
																				<div class="td1">
																					<span class="red"></span><span>出生日期：</span>
																				</div>
																				<div class="td2">
																					 <span><input type="text" class="radius3 input" id="stuBirthDate" name="stuBirthDate" th:value="${stu.stuBirthDate}"  onfocus="WdatePicker({dateFmt:'yyyy-MM-dd',maxDate:'new Date();',readOnly:true})" /></span>
																				</div>
																			</div>	
																		</td>
																	</tr> -->
																<tr>
																	<td>
																		<div class="left">
																			<div class="td1">
																				<span class="red"></span><span>所学专业：</span>
																			</div>
																			<div class="td2">
																				<span> <input type="text"
																					class="radius3 input" id="stuSpecialty"
																					name="stuSpecialty" th:value="${stu.stuSpecialty}" /></span>
																			</div>
																		</div>
																	</td>
																</tr>
																<tr>
																	<td>
																		<div class="left">
																			<div class="td1">
																				<span class="red"></span><span>学员备注：</span>
																			</div>
																			<div class="td2">
																				<span> <input type="text"
																					class="radius3 input" id="stuRemark"
																					name="stuRemark" th:value="${stu.stuRemark}" /></span>
																			</div>
																		</div>
																		<div class="td1">
																				<span>操作时间：</span><span class="red"
																					style="cursor: pointer"
																					baisee:fmt="yyyy-MM-dd,${updateTime}"></span>
																			</div>
																	</td>
																</tr>
															</table>
															<div class="redbutton control-button JsW">
																<span class="grey"> <input value="返回上级"
																	type="button" onclick="returnBack();"
																	class="radius5 button ks-pop-close1" />
																</span> <span baisee:ctrl="ZSXYGL_XYXG"> <input
																	value="确定保存" type="submit"
																	class="radius5 button ks-pop-close1" />
																</span>

															</div>
														</form>
													</div>
												</div>
											</div>
										</div>
									</div>
								</div>
								<!-- ============================= 页面内容 结束============================= -->
							</div>
						</div>
					</div>
				</div>
				<div th:include="commonTemplate :: leftMenus"></div>
			</div>
		</div>
		<div th:include="commonTemplate :: footer"></div>
	</div>
	<div th:include="commonTemplate :: processBar" />
	<script th:inline="javascript">
					$(function(){
						//默认选中
						$("#class_select").val([[${stu.claId}]]);
						});
		</script>
	<script th:inline="javascript"> 
		
		$(function(){
			var operationSuccess = $("#operationSuccess").val();
			if(operationSuccess != ""){
				_alert(operationSuccess);
			}
		});
		$(function(){
			setValidate($("#basefrm"),{
				rules: {
					stuName:{required: true,number: false,stuName: true, maxlength: 21,minlength:2},
					stuIdNumber:{required: true,ID_number: true,
						remote:{       
				              type : "POST",
				              url : [[@{/stu/VerificationStuID.ht}]],
				              cache:true,
				              async: true,
				              data : {
				            	 "stuIdNumber" : function(){return $("#stuIdNumber").val();},
				            	 "stuId" : function(){return $("#stuId").val();}
				              },
				          } 
					},
					stuMobile:{required: true,phone_number: true, maxlength: 11,
						remote:{       
				              type : "POST",
				              url : [[@{/stu/VerificationStuMobile.ht}]],
				              cache:true,
				              async: true,
				              data : { 
				            	 "stuMobile" : function(){return $("#stuMobile").val();}, 
								"stuId" : function(){return $("#stuId").val();}
				              },
				          } 		
					}
				},
				messages:{
					stuName:{required: "*请输入姓名!",number:"*输入正确的姓名!",maxlength: "*长度最大21位字符!",minlength:"*长度最小2位字符!"},
					stuMobile:{required: "*请填写手机号码!", maxlength: "*输入正确手机格式!",remote:"*该手机号已被注册!"},
					stuIdNumber:{required: "*请填身份证号码!",remote:"*已有该学员或员工!"}
				}
			}
			);
				
				/*=====================================身份证号验证=============================================*/
				$.validator.addMethod("ID_number", function(value, element) { 
					var length = value.length; 
					var ID_number = /^[1-9]\d{7}((0[1-9])|(1[0-2]))(([0|1|2]\d)|3[0-1])\d{3}$|^[1-9]\d{5}[1-9]\d{3}((0[1-9])|(1[0-2]))(([0|1|2]\d)|3[0-1])\d{3}([0-9]|X)$/
					return this.optional(element) || (ID_number.test(value)); 
				}, "*身份证号码格式错误!");
				/* =========================================手机号码校验======================================================= */
				$.validator.addMethod("phone_number", function(value, element) { 
					var length = value.length; 
					//var phone_number = /^((13[0-9])|(14[5,7,9])|(15[^4])|(18[0-9])|(17[0,1,3,5,6,7,8]))\d{8}$/ 
					var phone_number = /^((1[0-9][0-9]))\d{8}$/;
					return this.optional(element) || (phone_number.test(value)); 
				}, "*手机号码格式错误!");
				/*=====================================姓名验证=============================================*/
				$.validator.addMethod("stuName", function(value, element) { 
					var length = value.length; 
					var stuName =  /^[\u4E00-\u9FA5A-Za-z]+$/
						
					return this.optional(element) || (stuName.test(value)); 
				}, "*姓名只能输入中文和英文!"); 
				
				$("#class_select").select2({
					placeholder : "请选择班级"
				});
				$("#stuSex").select2({
					placeholder : "请选择性别"
				});
			});
		
		
		
		function notSupJump(){
			var stuId = document.getElementById("stuId").value;
			if(stuId==null || stuId == ""){
				_alert("请先保存当前页面");
			}else {
				locationHref([[@{'/stu/stuPageJump.ht'}]] + "?stuTable=forStudentSupplementJump");
			}
		};
		function notEduJump(){
			var stuId = document.getElementById("stuId").value;
			if(stuId==null || stuId == ""){
				_alert("请先保存当前页面");
			}else {
				locationHref([[@{'/stu/stuPageJump.ht'}]] + "?stuTable=forStudentEducationJump");
			}
		};
		
		function notFamJump(){
			var stuId = document.getElementById("stuId").value;
			if(stuId==null || stuId == ""){
				_alert("请先保存当前页面");
			}else {
				locationHref([[@{'/stu/stuPageJump.ht'}]] + "?stuTable=forStudentFamilyJump");
			}
		};
		function returnBack(){
			var url = [[@{'/stu/toForStuList.ht'}]];
			locationHref(url);
		};
		
		function openHou(id) {
		     var logUrl = [[@{'/stu/updateStuState.ht?sId='}]] + id;
			$.ajax({
				url: logUrl,
				type:'post',
				success:function(data){
					if (data.flag == "success") {
						_alert("开户成功");
						 var succ=[[@{'/stu/toForStuList.ht'}]]; 
						locationHref(succ);
					}  else {
						_alert("开户失败");
					}
				}
			})
			
		}
		
		function logout(id) {
		     var logUrl = [[@{'/stu/deleteStuUser.ht?sId='}]] + id;
			$.ajax({
				url: logUrl,
				type:'post',
				success:function(data){
					if (data.flag == "success") {
						_alert("注销成功");
						 var succ=[[@{'/stu/toForStuList.ht'}]]; 
						locationHref(succ);
					}  else {
						_alert("注销失败");
					}
				}
			})
			
		} 
		</script>

</body>
</html>